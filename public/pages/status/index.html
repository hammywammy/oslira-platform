<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Status - Oslira</title>
    <meta name="description" content="Real-time status of Oslira's services and infrastructure">
    <meta name="keywords" content="Oslira status, service status, uptime, system status, API status">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Service Status - Oslira">
    <meta property="og:description" content="Real-time status of Oslira's services and infrastructure">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://oslira.com/footer/status">
    
    <link rel="preload" href="/assets/images/oslira-logo.png" as="image">
    
    <!-- Favicon -->
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="/assets/css/tailwind.css">

    <!-- Script loader initialization -->
<script src="/core/script-loader.js"></script>
    
    <!-- Stylesheets -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* =============================================================================
           RESET & BASE STYLES
           ============================================================================= */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background-color: #f8fafc;
            min-height: 100vh;
        }
        
        /* =============================================================================
           CONTAINER & LAYOUT
           ============================================================================= */
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        
        .main-content {
            margin-top: 2rem;
            margin-bottom: 4rem;
            min-height: 70vh;
        }
        
        /* =============================================================================
           STATUS PAGE HEADER
           ============================================================================= */
        
        .status-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0 3rem;
            text-align: center;
        }
        
        .status-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .status-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .overall-status {
            margin-top: 2rem;
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            display: inline-block;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-dot.operational {
            background: #10b981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.3);
        }
        
        .status-dot.degraded {
            background: #f59e0b;
            box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.3);
        }
        
        .status-dot.outage {
            background: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.3);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* =============================================================================
           STATUS CARDS
           ============================================================================= */
        
        .status-content {
            padding: 3rem 0;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .status-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .status-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
        }
        
        .service-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .service-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .service-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }
        
        .service-icon.api { background: #3b82f6; }
        .service-icon.web { background: #10b981; }
        .service-icon.db { background: #8b5cf6; }
        .service-icon.ai { background: #f59e0b; }
        .service-icon.payments { background: #ef4444; }
        
        .service-details h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .service-description {
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .service-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .service-status.operational { color: #10b981; }
        .service-status.degraded { color: #f59e0b; }
        .service-status.outage { color: #ef4444; }
        
        .service-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        .metric-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .no-incidents {
    @apply text-center py-12;
}

.no-incidents-icon {
    @apply text-6xl mb-4;
}

.no-incidents-title {
    @apply text-xl font-semibold text-gray-800 mb-2;
}

.no-incidents-description {
    @apply text-gray-600;
}
        
        /* =============================================================================
           INCIDENT TIMELINE
           ============================================================================= */
        
        .incident-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-top: 3rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .incident-timeline {
            position: relative;
        }
        
        .incident-item {
            position: relative;
            padding: 1.5rem 0;
            border-left: 2px solid #e5e7eb;
            margin-left: 1rem;
            padding-left: 2rem;
        }
        
        .incident-item:before {
            content: '';
            position: absolute;
            left: -8px;
            top: 2rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            border: 2px solid white;
            box-shadow: 0 0 0 2px #10b981;
        }
        
        .incident-item.warning:before {
            background: #f59e0b;
            box-shadow: 0 0 0 2px #f59e0b;
        }
        
        .incident-item.error:before {
            background: #ef4444;
            box-shadow: 0 0 0 2px #ef4444;
        }
        
        .incident-date {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .incident-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .incident-description {
            color: #4b5563;
            line-height: 1.6;
        }
        
        .incident-status {
            margin-top: 0.75rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .incident-status.resolved {
            background: #d1fae5;
            color: #065f46;
        }
        
        .incident-status.investigating {
            background: #fef3c7;
            color: #92400e;
        }
        
        .incident-status.monitoring {
            background: #dbeafe;
            color: #1e40af;
        }
        
        /* =============================================================================
           UPTIME CHART PLACEHOLDER
           ============================================================================= */
        
        .uptime-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .uptime-chart {
            background: #f8fafc;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            color: #6b7280;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1rem;
        }
        
        .uptime-bars {
            display: flex;
            gap: 2px;
            justify-content: center;
            align-items: end;
            height: 60px;
            margin: 1rem 0;
        }
        
        .uptime-bar {
            width: 4px;
            background: #10b981;
            border-radius: 2px;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .uptime-bar:hover {
            opacity: 1;
            transform: scaleY(1.1);
        }
        
        /* Generate random heights for visual effect */
        .uptime-bar:nth-child(1) { height: 45px; }
        .uptime-bar:nth-child(2) { height: 52px; }
        .uptime-bar:nth-child(3) { height: 48px; }
        .uptime-bar:nth-child(4) { height: 58px; }
        .uptime-bar:nth-child(5) { height: 44px; }
        .uptime-bar:nth-child(6) { height: 60px; }
        .uptime-bar:nth-child(7) { height: 46px; }
        .uptime-bar:nth-child(8) { height: 55px; }
        .uptime-bar:nth-child(9) { height: 49px; }
        .uptime-bar:nth-child(10) { height: 57px; }
        .uptime-bar:nth-child(11) { height: 53px; }
        .uptime-bar:nth-child(12) { height: 60px; }
        .uptime-bar:nth-child(13) { height: 47px; }
        .uptime-bar:nth-child(14) { height: 54px; }
        .uptime-bar:nth-child(15) { height: 51px; }
        .uptime-bar:nth-child(16) { height: 59px; }
        .uptime-bar:nth-child(17) { height: 45px; }
        .uptime-bar:nth-child(18) { height: 56px; }
        .uptime-bar:nth-child(19) { height: 50px; }
        .uptime-bar:nth-child(20) { height: 60px; }
        .uptime-bar:nth-child(21) { height: 43px; }
        .uptime-bar:nth-child(22) { height: 58px; }
        .uptime-bar:nth-child(23) { height: 52px; }
        .uptime-bar:nth-child(24) { height: 47px; }
        .uptime-bar:nth-child(25) { height: 55px; }
        .uptime-bar:nth-child(26) { height: 49px; }
        .uptime-bar:nth-child(27) { height: 60px; }
        .uptime-bar:nth-child(28) { height: 46px; }
        .uptime-bar:nth-child(29) { height: 53px; }
        .uptime-bar:nth-child(30) { height: 57px; }
        
        /* =============================================================================
           RESPONSIVE DESIGN
           ============================================================================= */
        
        @media (max-width: 768px) {
            .status-title {
                font-size: 2rem;
            }
            
            .status-subtitle {
                font-size: 1rem;
            }
            
            .status-grid {
                grid-template-columns: 1fr;
            }
            
            .service-metrics {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .status-card {
                padding: 1.5rem;
            }
            
            .uptime-bars {
                gap: 1px;
            }
            
            .uptime-bar {
                width: 3px;
            }
        }
        
        /* =============================================================================
           LOADING STATES
           ============================================================================= */
        
        .loading {
            animation: loading-pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes loading-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>

<body>
    <!-- Header Container -->
    <div id="header-container"></div>
    
    <!-- Status Header -->
    <section class="status-header">
        <div class="container">
            <h1 class="status-title">Service Status</h1>
            <p class="status-subtitle">
                Real-time monitoring of all Oslira services and infrastructure components
            </p>
            
            <div class="overall-status">
                <div class="status-indicator">
                    <div class="status-dot operational"></div>
                    <span>All Systems Operational</span>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="status-content">
                
                <!-- Service Status Grid -->
                <div class="status-grid">
                    
                    <!-- Web Application -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon web">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="service-details">
                                    <h3>Web Application</h3>
                                    <div class="service-description">Main application interface</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">99.9%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">1.2s</div>
                                <div class="metric-label">Avg response</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- API Services -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon api">
                                    <i class="fas fa-code"></i>
                                </div>
                                <div class="service-details">
                                    <h3>API Services</h3>
                                    <div class="service-description">Core API and endpoints</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">99.8%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">340ms</div>
                                <div class="metric-label">Avg response</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Database -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon db">
                                    <i class="fas fa-database"></i>
                                </div>
                                <div class="service-details">
                                    <h3>Database</h3>
                                    <div class="service-description">Data storage and retrieval</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">100%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">25ms</div>
                                <div class="metric-label">Avg query time</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Processing -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon ai">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="service-details">
                                    <h3>AI Processing</h3>
                                    <div class="service-description">Lead analysis and AI features</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">99.7%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">2.8s</div>
                                <div class="metric-label">Avg processing</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Authentication -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon web">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="service-details">
                                    <h3>Authentication</h3>
                                    <div class="service-description">User login and security</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">100%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">180ms</div>
                                <div class="metric-label">Avg response</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Processing -->
                    <div class="status-card">
                        <div class="service-header">
                            <div class="service-info">
                                <div class="service-icon payments">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="service-details">
                                    <h3>Payment Processing</h3>
                                    <div class="service-description">Billing and subscriptions</div>
                                </div>
                            </div>
                            <div class="service-status operational">
                                <i class="fas fa-check-circle"></i>
                                Operational
                            </div>
                        </div>
                        <div class="service-metrics">
                            <div class="metric">
                                <div class="metric-value">99.9%</div>
                                <div class="metric-label">30-day uptime</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">450ms</div>
                                <div class="metric-label">Avg response</div>
                            </div>
                        </div>
                    </div>
                    
                </div>
                
                <!-- Uptime Chart -->
                <div class="uptime-section">
                    <h2 class="section-title">
                        <i class="fas fa-chart-line"></i>
                        90-Day Uptime History
                    </h2>
                    <div class="uptime-chart">
                        <div class="uptime-bars">
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                            <div class="uptime-bar"></div>
                        </div>
                        <p>Each bar represents one day. All bars green indicates 100% uptime.</p>
                    </div>
                </div>
                
                <!-- Recent Incidents -->
                <div class="incident-section">
                    <h2 class="section-title">
                        <i class="fas fa-history"></i>
                        Recent Incidents
                    </h2>
                    
                    <div class="incident-timeline">
                        <div class="incident-item">
                            <div class="incident-date">January 15, 2025 - 14:30 UTC</div>
                            <div class="incident-title">Scheduled Maintenance - Database Optimization</div>
                            <div class="incident-description">
                                Routine database maintenance performed to optimize query performance. All services remained operational during maintenance window.
                            </div>
                            <div class="incident-status resolved">Completed</div>
                        </div>
                        
                        <div class="incident-item warning">
                            <div class="incident-date">January 12, 2025 - 09:15 UTC</div>
                            <div class="incident-title">Increased API Response Times</div>
                            <div class="incident-description">
                                Temporary spike in API response times due to increased load. Automatically resolved by scaling infrastructure. No service interruption occurred.
                            </div>
                            <div class="incident-status resolved">Resolved</div>
                        </div>
                        
                        <div class="incident-item">
                            <div class="incident-date">January 8, 2025 - 16:45 UTC</div>
                            <div class="incident-title">Security Update Deployment</div>
                            <div class="incident-description">
                                Deployed security patches across all infrastructure components. Brief service restart performed with zero downtime achieved through rolling updates.
                            </div>
                            <div class="incident-status resolved">Completed</div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </main>
    
    <!-- Footer Container -->
    <div id="footer-container"></div>
    
<script>
let footerInitialized = false;

// Wait for scripts loaded event  
window.addEventListener('oslira:scripts:loaded', async () => {
    // Initialize header first
    try {
        await initializeHeader();
    } catch (error) {
        console.error('❌ [Status] Header initialization failed:', error);
    }
    
    if (footerInitialized) {
        console.log('🔄 [Status] Footer already initialized, skipping...');
        return;
    }
    
    console.log('🚀 [Status] Scripts loaded event received, initializing footer...');
    try {
        footerInitialized = true;
        await initializeFooter();
        await initializeStatusData();
    } catch (error) {
        console.error('❌ [Status] Footer initialization failed:', error);
        footerInitialized = false;
    }
});

async function initializeHeader() {
    try {
        if (document.querySelector('.home-nav')) {
            console.log('🔄 [Status] Header already exists, skipping initialization...');
            return;
        }
        
        console.log('🧭 [Status] Starting header initialization...');
        
        let container = document.getElementById('header-container');
        if (!container) {
            console.log('🔧 [Status] Creating header-container element');
            container = document.createElement('div');
            container.id = 'header-container';
            document.body.insertBefore(container, document.body.firstChild);
        }
        
        // Wait for HeaderManager to be available
        console.log('🔍 [Status] Waiting for HeaderManager...');
        for (let i = 0; i < 50; i++) {
            if (window.HeaderManager) {
                console.log('✅ [Status] HeaderManager found');
                break;
            }
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        if (!window.HeaderManager) {
            throw new Error('HeaderManager not available after waiting');
        }
        
        // Initialize header for footer pages
        console.log('🧭 [Status] Creating HeaderManager instance...');
        const headerManager = new window.HeaderManager();
        
        console.log('🧭 [Status] Rendering header...');
        headerManager.render('header-container', {
            type: 'footer-pages'
        });
        
        console.log('✅ [Status] Header initialization complete');
    } catch (error) {
        console.error('❌ [Status] Header initialization failed:', error);
    }
}

async function initializeFooter() {
    try {
        // Check if footer already exists
        if (document.querySelector('.new-footer-main')) {
            console.log('🔄 [Status] Footer already exists, skipping initialization...');
            return;
        }
        
        console.log('🦶 [Status] Starting footer initialization...');
        
        // Check if container exists
        let container = document.getElementById('footer-container');
        if (!container) {
            console.log('🔧 [Status] Creating footer-container element');
            container = document.createElement('div');
            container.id = 'footer-container';
            document.body.appendChild(container);
        }
        
        // Wait for FooterManager to be available
        console.log('🔍 [Status] Waiting for FooterManager...');
        for (let i = 0; i < 50; i++) {
            if (window.FooterManager) {
                console.log('✅ [Status] FooterManager found');
                break;
            }
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        if (!window.FooterManager) {
            throw new Error('FooterManager not available after waiting');
        }
        
        // Create FooterManager instance
        console.log('🦶 [Status] Creating FooterManager instance...');
        const footerManager = new window.FooterManager();
        
        console.log('🦶 [Status] Rendering footer...');
        footerManager.render('footer-container');
        
        console.log('✅ [Status] Footer initialization complete');
        
    } catch (error) {
        console.error('❌ [Status] Footer initialization failed:', error);
    }
}

async function initializeStatusData() {
    try {
        console.log('📊 [Status] Initializing status data...');
        
        // Load initial status data from UptimeRobot
        await fetchUptimeRobotData();
        
        // Add auto-refresh functionality
        setInterval(refreshStatusData, 60000); // Refresh every 60 seconds
        
        console.log('✅ [Status] Status data initialized');
        
    } catch (error) {
        console.error('❌ [Status] Status data initialization failed:', error);
        // Show cached/fallback data on error
        showFallbackData();
    }
}

async function refreshStatusData() {
    try {
        console.log('🔄 [Status] Refreshing status data...');
        await fetchUptimeRobotData();
        
        const now = new Date().toLocaleString();
        console.log(`📊 [Status] Data refreshed at ${now}`);
        
    } catch (error) {
        console.error('❌ [Status] Data refresh failed:', error);
    }
}

// =============================================================================
// UPTIMEROBOT API INTEGRATION
// =============================================================================

const UPTIME_ROBOT_CONFIG = {
    // Get your API key from https://uptimerobot.com/dashboard/settings/api
    apiKey: 'ur3007898-5a5cbbd71eeb3fc2ca50846c', // Replace with your actual API key
    
    // Map your UptimeRobot monitor IDs to service cards
    monitorMap: {
        'web-app': 'ur3007898-5a5cbbd71eeb3fc2ca50846c',      // Replace with your actual monitor ID
        'api': 'ur3007898-5a5cbbd71eeb3fc2ca50846c',          // Replace with your actual monitor ID  
        'database': 'ur3007898-5a5cbbd71eeb3fc2ca50846c',     // Replace with your actual monitor ID
        'ai-processing': 'ur3007898-5a5cbbd71eeb3fc2ca50846c', // Replace with your actual monitor ID
        'auth': 'ur3007898-5a5cbbd71eeb3fc2ca50846c',         // Replace with your actual monitor ID
        'payments': 'ur3007898-5a5cbbd71eeb3fc2ca50846c'      // Replace with your actual monitor ID
    }
};

async function fetchUptimeRobotData() {
    try {
        console.log('🔄 [Status] Fetching UptimeRobot data...');
        
        const response = await fetch('https://api.uptimerobot.com/v2/getMonitors', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({
                'api_key': UPTIME_ROBOT_CONFIG.apiKey,
                'format': 'json',
                'logs': '1',
                'logs_limit': '50',
                'response_times': '1',
                'response_times_limit': '30',
                'all_time_uptime_ratio': '1',
                'custom_uptime_ratio': '1-7-30'
            })
        });
        
        if (!response.ok) {
            throw new Error(`UptimeRobot API error: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.stat === 'fail') {
            throw new Error(`UptimeRobot API error: ${data.error?.message || 'Unknown error'}`);
        }
        
        console.log('✅ [Status] UptimeRobot data fetched successfully');
        updateStatusFromUptimeRobot(data.monitors);
        updateIncidentTimeline(data.monitors);
        
    } catch (error) {
        console.error('❌ [Status] Failed to fetch UptimeRobot data:', error);
        throw error;
    }
}

function updateStatusFromUptimeRobot(monitors) {
    // Update overall status
    let allOperational = true;
    let hasWarnings = false;
    
    monitors.forEach(monitor => {
        console.log('📊 [Status] Processing monitor:', {
            id: monitor.id,
            name: monitor.friendly_name,
            status: monitor.status,
            uptime: monitor.all_time_uptime_ratio
        });
        
        // Find which service this monitor corresponds to
        const serviceId = Object.keys(UPTIME_ROBOT_CONFIG.monitorMap).find(
            key => UPTIME_ROBOT_CONFIG.monitorMap[key] == monitor.id
        );
        
        if (!serviceId) return;
        
        // UptimeRobot status codes: 0=paused, 1=not checked, 2=up, 8=seems down, 9=down
        let status = 'operational';
        if (monitor.status === 0 || monitor.status === 1) { // Paused or not checked
            status = 'degraded';
            hasWarnings = true;
            allOperational = false;
        } else if (monitor.status === 8 || monitor.status === 9) { // Down
            status = 'outage';
            allOperational = false;
        } else if (monitor.status === 2) { // Up
            status = 'operational';
        }
        
        // Calculate uptime percentage
        const uptimeRatio = monitor.all_time_uptime_ratio || 100;
        const uptimePercent = `${uptimeRatio.toFixed(1)}%`;
        
        // Get average response time from recent logs
        let avgResponse = 'N/A';
        if (monitor.response_times && monitor.response_times.length > 0) {
            const totalTime = monitor.response_times.reduce((sum, rt) => sum + rt.value, 0);
            const avgTime = totalTime / monitor.response_times.length;
            avgResponse = avgTime > 1000 ? `${(avgTime/1000).toFixed(1)}s` : `${Math.round(avgTime)}ms`;
        }
        
        // Update the service card
        updateServiceCard(serviceId, {
            status: status,
            uptime: uptimePercent,
            response: avgResponse,
            lastCheck: new Date(monitor.last_heartbeat * 1000)
        });
    });
    
    // Update overall status indicator
    updateOverallStatus(allOperational, hasWarnings);
}

function updateServiceCard(serviceId, data) {
    const serviceCards = {
        'web-app': 0,
        'api': 1,
        'database': 2,
        'ai-processing': 3,
        'auth': 4,
        'payments': 5
    };
    
    const cardIndex = serviceCards[serviceId];
    if (cardIndex === undefined) return;
    
    const cards = document.querySelectorAll('.status-card');
    const card = cards[cardIndex];
    if (!card) return;
    
    // Update status indicator
    const statusElement = card.querySelector('.service-status');
    statusElement.className = `service-status ${data.status}`;
    
    const statusText = {
        'operational': { text: 'Operational', icon: 'fas fa-check-circle' },
        'degraded': { text: 'Degraded', icon: 'fas fa-exclamation-triangle' },
        'outage': { text: 'Outage', icon: 'fas fa-times-circle' }
    };
    
    statusElement.innerHTML = `
        <i class="${statusText[data.status].icon}"></i>
        ${statusText[data.status].text}
    `;
    
    // Update metrics
    const metricValues = card.querySelectorAll('.metric-value');
    if (metricValues[0]) metricValues[0].textContent = data.uptime;
    if (metricValues[1]) metricValues[1].textContent = data.response;
}

function updateOverallStatus(allOperational, hasWarnings) {
    const overallStatus = document.querySelector('.overall-status .status-indicator');
    const statusDot = overallStatus.querySelector('.status-dot');
    const statusText = overallStatus.querySelector('span');
    
    // Remove existing classes
    statusDot.className = 'status-dot';
    
    if (allOperational) {
        statusDot.classList.add('operational');
        statusText.textContent = 'All Systems Operational';
    } else if (hasWarnings) {
        statusDot.classList.add('degraded');
        statusText.textContent = 'Some Systems Degraded';
    } else {
        statusDot.classList.add('outage');
        statusText.textContent = 'Service Outage Detected';
    }
}

function updateIncidentTimeline(monitors) {
    const timeline = document.getElementById('incident-timeline');
    if (!timeline) return;
    
    // Clear existing incidents
    timeline.innerHTML = '';
    
    let hasIncidents = false;
    
    monitors.forEach(monitor => {
        // Check for recent incidents in logs
        if (monitor.logs && monitor.logs.length > 0) {
            monitor.logs.forEach(log => {
                if (log.type === 1) { // Down event
                    hasIncidents = true;
                    const incidentDate = new Date(log.datetime * 1000);
                    const duration = log.duration ? `${Math.round(log.duration / 60)} minutes` : 'Unknown duration';
                    
                    const incidentHTML = `
                        <div class="incident-item error">
                            <div class="incident-date">${incidentDate.toLocaleString()}</div>
                            <div class="incident-title">Service Interruption - ${monitor.friendly_name}</div>
                            <div class="incident-description">
                                Service was temporarily unavailable. Duration: ${duration}
                            </div>
                            <div class="incident-status resolved">Resolved</div>
                        </div>
                    `;
                    
                    timeline.insertAdjacentHTML('afterbegin', incidentHTML);
                }
            });
        }
    });
    
    // Show no incidents message if none found
    if (!hasIncidents) {
        timeline.innerHTML = `
            <div class="no-incidents">
                <div class="no-incidents-icon">👍</div>
                <div class="no-incidents-title">All Systems Running Smoothly</div>
                <div class="no-incidents-description">No incidents reported in the last 30 days.</div>
            </div>
        `;
    }
}

function showFallbackData() {
    console.log('📊 [Status] Showing fallback data due to API failure');
    // Keep existing static data as fallback
}

// Make functions available globally for debugging
window.debugStatus = {
    refreshStatusData,
    getInitializationStatus: () => ({
        footer: footerInitialized
    })
};

console.log('📊 [Status] Status page script loaded');
</script>
    
</body>
</html>
