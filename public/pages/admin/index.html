<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - OSLIRA</title>
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    
    <!-- Page-specific metadata -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="OSLIRA Admin Panel - Platform Management">
    
    <!-- CRITICAL: Inline CSS to block page immediately -->
    <style>
        /* Hide everything until admin guard approves */
        html, body {
            visibility: hidden !important;
            opacity: 0 !important;
            overflow: hidden !important;
        }
        
        /* Only password screen is visible */
        #admin-password-screen,
        #admin-password-screen * {
            visibility: visible !important;
            opacity: 1 !important;
        }
    </style>
</head>
<body class="admin-page">
<!-- REMOVE env-manager.js from here - script-loader will load it -->
    <script src="/core/env-manager.js"></script>
<script src="/pages/admin/admin-guard.js"></script>

<script>
    console.log('üìã [Admin] Waiting for guard authorization...');
    
    window.addEventListener('admin:guard:passed', function(event) {
        console.log('üîì [Admin] Guard passed - loading scripts', event.detail);
        
        window.OSLIRA_PAGE = 'admin';
        
        const scriptLoader = document.createElement('script');
        scriptLoader.src = '/core/script-loader.js';
        scriptLoader.onload = function() {
            console.log('‚úÖ [Admin] Script loader initialized');
        };
        scriptLoader.onerror = function() {
            console.error('‚ùå [Admin] Failed to load script-loader');
            // Show error in a simple div
            document.body.innerHTML = '<div style="padding: 2rem; text-align: center;"><h2>Failed to load admin panel</h2><p>Please refresh the page</p></div>';
        };
        document.head.appendChild(scriptLoader);
    });
</script>

<!-- Admin Page Content Structure (injected after guard passes) -->
<div id="admin-page-root" style="display: none;">
    <!-- Gradient Background -->
    <div class="admin-gradient-bg"></div>
    
    <!-- Sidebar will be injected here by AdminSidebarManager -->
    
    <!-- Main Content Area -->
    <main id="admin-main-content" class="admin-main-content">
        <div class="admin-content-container">
            <!-- Section content container -->
            <div id="admin-section-content"></div>
        </div>
    </main>
    
    <!-- Loading State -->
    <div id="admin-loading" class="admin-loading-overlay">
        <div class="admin-loading-spinner"></div>
        <p class="admin-loading-text">Loading admin panel...</p>
    </div>
    
    <!-- Error State -->
    <div id="admin-error" class="admin-error-overlay hidden">
        <div class="admin-error-content">
            <div class="admin-error-icon">‚ö†Ô∏è</div>
            <h2 class="admin-error-title">Error Loading Admin Panel</h2>
            <p id="admin-error-message" class="admin-error-message"></p>
            <button onclick="window.location.reload()" class="btn-primary">Reload Page</button>
        </div>
    </div>
</div>
</body>
</html>
