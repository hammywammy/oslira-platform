<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report a Bug - Oslira</title>
    <meta name="description" content="Report bugs and issues to help improve Oslira">
    <meta name="robots" content="index, follow">
    
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    <script src="/core/script-loader.js"></script>
    
    <style>
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.5rem;
        }
        
        .form-required {
            color: #dc2626;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .submit-button {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 1.125rem;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }
        
        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.4);
        }
        
        .submit-button:active {
            transform: translateY(0);
        }
        
        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .guideline-box {
            background: #eff6ff;
            border: 2px solid #3b82f6;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .example-box {
            background: #f9fafb;
            border-left: 4px solid #10b981;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        
        .success-message {
            background: #d1fae5;
            border: 2px solid #10b981;
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            display: none;
        }
        
        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-label {
            display: block;
            padding: 0.75rem 1rem;
            border: 2px dashed #e5e7eb;
            border-radius: 0.5rem;
            text-align: center;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .file-input-label:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
    </style>
</head>
<body style="background-color: #f8fafc; min-height: 100vh;">
    <div id="header-container"></div>

    <!-- Hero Section -->
    <section class="contact-hero" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
        <div class="contact-container">
            <div style="text-align: center; margin-bottom: 1rem;">
                <span style="font-size: 4rem;">üêõ</span>
            </div>
            <h1 class="contact-hero-title">Report a Bug</h1>
            <p class="contact-hero-subtitle">Help us improve Oslira by reporting issues you encounter</p>
        </div>
    </section>

    <!-- Main Content -->
    <section class="contact-section">
        <div class="contact-container" style="max-width: 56rem;">
            
            <!-- Thank You Message -->
            <div style="background: white; border-radius: 1rem; padding: 2rem; margin-bottom: 2rem; text-align: center; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                <h2 style="font-size: 1.5rem; font-weight: 700; color: #111827; margin-bottom: 0.5rem;">Thank You for Helping! üôè</h2>
                <p style="color: #6b7280;">Your bug reports help us make Oslira better for everyone</p>
            </div>

            <!-- Guidelines -->
            <div class="guideline-box">
                <h3 style="font-size: 1.25rem; font-weight: 700; color: #1e40af; margin-bottom: 1rem;">üìã What Makes a Good Bug Report</h3>
                <ul style="color: #1e3a8a; line-height: 1.8; margin: 0; padding-left: 1.5rem;">
                    <li><strong>Clear title:</strong> Summarize the issue in one sentence</li>
                    <li><strong>Detailed description:</strong> Explain what happened</li>
                    <li><strong>Steps to reproduce:</strong> How can we make it happen again?</li>
                    <li><strong>Expected vs actual:</strong> What should happen vs what did happen</li>
                    <li><strong>Screenshots:</strong> Visual evidence helps tremendously</li>
                </ul>
                
                <div class="example-box">
                    <strong style="color: #059669;">‚úì Good Example:</strong>
                    <p style="color: #374151; margin: 0.5rem 0 0 0; font-size: 0.875rem;">"Login button doesn't respond on mobile Safari - When I tap the login button on iPhone 13 (iOS 16), nothing happens. Expected: Should navigate to dashboard."</p>
                </div>
            </div>

            <!-- Success Message (Hidden by default) -->
            <div id="successMessage" class="success-message">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚úÖ</div>
                <h2 style="font-size: 1.875rem; font-weight: 700; color: #059669; margin-bottom: 0.5rem;">Bug Report Submitted!</h2>
                <p style="color: #065f46; margin-bottom: 1rem;">Thank you for your report. We've received it and will investigate.</p>
                <p style="color: #065f46; font-weight: 600;">Ticket #<span id="ticketNumber"></span></p>
                <p style="color: #6b7280; font-size: 0.875rem; margin-top: 1rem;">Check your email for confirmation and updates</p>
            </div>

            <!-- Bug Report Form -->
            <form id="bugReportForm" style="background: white; border-radius: 1rem; padding: 2rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                
                <!-- Name -->
                <div class="form-group">
                    <label class="form-label">
                        Your Name <span class="form-required">*</span>
                    </label>
                    <input type="text" name="name" class="form-input" placeholder="John Doe" required>
                </div>

                <!-- Email -->
                <div class="form-group">
                    <label class="form-label">
                        Email Address <span class="form-required">*</span>
                    </label>
                    <input type="email" name="email" class="form-input" placeholder="you@example.com" required>
                    <p style="color: #6b7280; font-size: 0.875rem; margin-top: 0.5rem;">We'll send updates about your bug report to this email</p>
                </div>

                <!-- Bug Title -->
                <div class="form-group">
                    <label class="form-label">
                        Bug Title/Summary <span class="form-required">*</span>
                    </label>
                    <input type="text" name="title" class="form-input" placeholder="Brief description of the issue" required>
                </div>

                <!-- Detailed Description -->
                <div class="form-group">
                    <label class="form-label">
                        Detailed Description <span class="form-required">*</span>
                    </label>
                    <textarea name="description" class="form-input form-textarea" placeholder="Describe what happened in detail..." required></textarea>
                </div>

                <!-- Steps to Reproduce -->
                <div class="form-group">
                    <label class="form-label">
                        Steps to Reproduce <span class="form-required">*</span>
                    </label>
                    <textarea name="steps" class="form-input form-textarea" placeholder="1. Go to...&#10;2. Click on...&#10;3. See error..." required></textarea>
                </div>

                <!-- Expected vs Actual Behavior -->
                <div class="form-group">
                    <label class="form-label">
                        Expected vs Actual Behavior <span class="form-required">*</span>
                    </label>
                    <textarea name="expected" class="form-input form-textarea" placeholder="Expected: The button should...&#10;Actual: Instead it..." required></textarea>
                </div>

                <!-- Browser/Device -->
                <div class="form-group">
                    <label class="form-label">
                        Browser & Device Information
                    </label>
                    <input type="text" name="device" class="form-input" placeholder="e.g., Chrome 120 on Windows 11" id="deviceInfo">
                    <p style="color: #6b7280; font-size: 0.875rem; margin-top: 0.5rem;">Auto-detected: <span id="autoDetected"></span></p>
                </div>

                <!-- URL -->
                <div class="form-group">
                    <label class="form-label">
                        Page URL Where Bug Occurred
                    </label>
                    <input type="url" name="url" class="form-input" placeholder="https://oslira.com/..." id="pageUrl">
                </div>

                <!-- Severity -->
                <div class="form-group">
                    <label class="form-label">
                        Severity <span class="form-required">*</span>
                    </label>
                    <select name="severity" class="form-select" required>
                        <option value="">Select severity...</option>
                        <option value="low">Low - Minor inconvenience</option>
                        <option value="medium">Medium - Affects functionality</option>
                        <option value="high">High - Blocks important features</option>
                        <option value="critical">Critical - System is unusable</option>
                    </select>
                </div>

                <!-- Screenshot -->
                <div class="form-group">
                    <label class="form-label">
                        Screenshot (Optional)
                    </label>
                    <div class="file-input-wrapper">
                        <input type="file" name="screenshot" class="file-input" accept="image/*" id="screenshotInput">
                        <label for="screenshotInput" class="file-input-label" id="fileLabel">
                            üìé Click to upload screenshot (PNG, JPG, GIF)
                        </label>
                    </div>
                    <p style="color: #6b7280; font-size: 0.875rem; margin-top: 0.5rem;" id="fileName"></p>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="submit-button">
                    Submit Bug Report
                </button>

            </form>

        </div>
    </section>

    <script>

// Auto-detect browser and device info
function detectBrowserInfo() {
    const userAgent = navigator.userAgent;
    let browserName = 'Unknown';
    let browserVersion = 'Unknown';
    let osName = 'Unknown';
    
    // Detect browser
    if (userAgent.indexOf('Firefox') > -1) {
        browserName = 'Firefox';
        browserVersion = userAgent.match(/Firefox\/(\d+)/)[1];
    } else if (userAgent.indexOf('Chrome') > -1 && userAgent.indexOf('Edg') === -1) {
        browserName = 'Chrome';
        browserVersion = userAgent.match(/Chrome\/(\d+)/)[1];
    } else if (userAgent.indexOf('Safari') > -1 && userAgent.indexOf('Chrome') === -1) {
        browserName = 'Safari';
        browserVersion = userAgent.match(/Version\/(\d+)/)[1];
    } else if (userAgent.indexOf('Edg') > -1) {
        browserName = 'Edge';
        browserVersion = userAgent.match(/Edg\/(\d+)/)[1];
    }
    
    // Detect OS
    if (userAgent.indexOf('Win') > -1) osName = 'Windows';
    else if (userAgent.indexOf('Mac') > -1) osName = 'macOS';
    else if (userAgent.indexOf('Linux') > -1) osName = 'Linux';
    else if (userAgent.indexOf('Android') > -1) osName = 'Android';
    else if (userAgent.indexOf('iOS') > -1 || userAgent.indexOf('iPhone') > -1 || userAgent.indexOf('iPad') > -1) osName = 'iOS';
    
    return `${browserName} ${browserVersion} on ${osName}`;
}

// Auto-fill device info on page load
window.addEventListener('DOMContentLoaded', function() {
    const deviceInfo = detectBrowserInfo();
    document.getElementById('autoDetected').textContent = deviceInfo;
    document.getElementById('deviceInfo').value = deviceInfo;
    
    // Auto-fill current page URL
    document.getElementById('pageUrl').value = window.location.href;
});

// File input handler
document.getElementById('screenshotInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const fileLabel = document.getElementById('fileLabel');
    const fileName = document.getElementById('fileName');
    
    if (file) {
        fileLabel.textContent = '‚úÖ File selected: ' + file.name;
        fileLabel.style.borderColor = '#10b981';
        fileLabel.style.background = '#d1fae5';
        fileName.textContent = `File: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
    } else {
        fileLabel.textContent = 'üìé Click to upload screenshot (PNG, JPG, GIF)';
        fileLabel.style.borderColor = '#e5e7eb';
        fileLabel.style.background = 'white';
        fileName.textContent = '';
    }
});

// Form submission handler
document.getElementById('bugReportForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitButton = e.target.querySelector('.submit-button');
    const originalText = submitButton.textContent;
    
    // Disable button and show loading state
    submitButton.disabled = true;
    submitButton.textContent = '‚è≥ Submitting...';
    
    // Get form data
    const formData = new FormData(e.target);
    
    // Generate ticket number
    const ticketNumber = 'BUG-' + Date.now().toString(36).toUpperCase() + '-' + Math.random().toString(36).substr(2, 4).toUpperCase();
    
    // Prepare email body
    const emailBody = `
Bug Report Submission
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Ticket Number: ${ticketNumber}
Submitted: ${new Date().toLocaleString()}

REPORTER INFORMATION
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Name: ${formData.get('name')}
Email: ${formData.get('email')}

BUG DETAILS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Title: ${formData.get('title')}

Description:
${formData.get('description')}

Steps to Reproduce:
${formData.get('steps')}

Expected vs Actual Behavior:
${formData.get('expected')}

TECHNICAL INFORMATION
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Browser/Device: ${formData.get('device')}
Page URL: ${formData.get('url') || 'Not provided'}
Severity: ${formData.get('severity').toUpperCase()}
Screenshot: ${formData.get('screenshot').name || 'Not provided'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
This bug report was submitted via the Oslira Bug Report Form.
    `.trim();
    
    try {
        // In production, you would send this to your backend/Cloudflare Worker
        // For now, we'll simulate the submission
        
        // Simulate API call delay
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Here's where you'd actually send to your backend:
        /*
        const response = await fetch('/api/submit-bug-report', {
            method: 'POST',
            body: formData
        });
        
        if (!response.ok) {
            throw new Error('Submission failed');
        }
        */
        
        // For now, just construct a mailto link as fallback
        const mailtoLink = `mailto:bugs@oslira.com?subject=Bug Report: ${encodeURIComponent(formData.get('title'))}&body=${encodeURIComponent(emailBody)}`;
        
        // Open mailto link (this is a fallback - in production you'd use a backend)
        // window.location.href = mailtoLink;
        
        // Show success message
        document.getElementById('bugReportForm').style.display = 'none';
        document.getElementById('successMessage').style.display = 'block';
        document.getElementById('ticketNumber').textContent = ticketNumber;
        
        // Scroll to success message
        document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // Send confirmation email data (in production, your backend would handle this)
        console.log('Bug report submitted:', {
            ticketNumber,
            name: formData.get('name'),
            email: formData.get('email'),
            title: formData.get('title'),
            severity: formData.get('severity')
        });
        
    } catch (error) {
        console.error('Error submitting bug report:', error);
        alert('Sorry, there was an error submitting your bug report. Please try emailing bugs@oslira.com directly.');
        submitButton.disabled = false;
        submitButton.textContent = originalText;
    }
});

// Initialize header and footer
let footerInitialized = false;

window.addEventListener('oslira:scripts:loaded', async () => {
    try {
        await initializeHeader();
    } catch (error) {
        console.error('‚ùå [BugReport] Header initialization failed:', error);
    }

    if (footerInitialized) return;
    
    try {
        footerInitialized = true;
        await initializeFooter();
    } catch (error) {
        console.error('‚ùå [BugReport] Footer initialization failed:', error);
        footerInitialized = false;
    }
});

async function initializeHeader() {
    if (document.querySelector('.home-nav')) return;
    
    let container = document.getElementById('header-container');
    if (!container) {
        container = document.createElement('div');
        container.id = 'header-container';
        document.body.insertBefore(container, document.body.firstChild);
    }
    
    for (let i = 0; i < 50; i++) {
        if (window.HeaderManager) break;
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    if (!window.HeaderManager) throw new Error('HeaderManager not available');
    
    const headerManager = new window.HeaderManager();
    headerManager.render('header-container', { type: 'footer-pages' });
}

async function initializeFooter() {
    if (document.querySelector('.new-footer-main')) return;
    
    let container = document.getElementById('footer-container');
    if (!container) {
        container = document.createElement('div');
        container.id = 'footer-container';
        document.body.appendChild(container);
    }
    
    for (let i = 0; i < 50; i++) {
        if (window.FooterManager) break;
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    if (!window.FooterManager) throw new Error('FooterManager not available');
    
    const footerManager = new window.FooterManager();
    footerManager.render('footer-container');
}
