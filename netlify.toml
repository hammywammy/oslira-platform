[build]
  publish = "public"
  command = "npm run build"
  edge_functions = "netlify/edge-functions"

[functions]
  directory = "netlify/edge-functions"

[[edge_functions]]
  function = "auth"
  path = "/api/*"

# ===========================
# üîí SECURITY HEADERS
# ===========================
[[headers]]
  for = "/*"
  [headers.values]
    Content-Security-Policy = """
      default-src 'self' https://*.supabase.co https://*.workers.dev https://*.stripe.com https://*.netlify.app https://*.oslira.com https://*.oslira.org;
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.supabase.co https://*.workers.dev https://*.stripe.com https://js.stripe.com https://unpkg.com https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://*.jsdelivr.net https://js.sentry-cdn.com https://browser.sentry-cdn.com https://*.oslira.com https://*.oslira.org;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://*.oslira.com https://*.oslira.org;
      font-src 'self' https://fonts.gstatic.com https://unpkg.com https://cdnjs.cloudflare.com https://*.oslira.com https://*.oslira.org;
      img-src 'self' data: https: blob: https://images.weserv.nl https://ui-avatars.com https://*.oslira.com https://*.oslira.org;
      connect-src 'self' https://*.supabase.co wss://*.supabase.co https://*.workers.dev https://*.stripe.com https://api.stripe.com https://browser.sentry-cdn.com https://sentry.io https://*.sentry.io https://api.oslira.com https://api.oslira.org https://unpkg.com https://*.oslira.com https://*.oslira.org https://api.uptimerobot.com;
      object-src 'none';
      base-uri 'self';
      form-action 'self' https://*.stripe.com https://*.oslira.com https://*.oslira.org;
    """
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    X-XSS-Protection = "1; mode=block"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Methods = "GET, POST, PUT, DELETE, OPTIONS"
    Access-Control-Allow-Headers = "Content-Type, Authorization"

# ===========================
# üåç APP SUBDOMAIN - app.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/dashboard/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/dashboard"
  to = "/pages/dashboard/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/analytics"
  to = "/pages/analytics/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/campaigns"
  to = "/pages/campaigns/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/leads"
  to = "/pages/leads/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/messages"
  to = "/pages/messages/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/integrations"
  to = "/pages/integrations/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/settings"
  to = "/pages/settings/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/subscription"
  to = "/pages/subscription/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/automations"
  to = "/pages/automations/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/onboarding"
  to = "/pages/onboarding/index.html"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/dashboard/:splat"
  status = 200
  conditions = {Host = ["app.oslira.com", "app.oslira.org"]}

# ===========================
# üîê AUTH SUBDOMAIN - auth.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/auth/index.html"
  status = 200
  conditions = {Host = ["auth.oslira.com", "auth.oslira.org"]}

[[redirects]]
  from = "/callback"
  to = "/pages/auth/callback.html"
  status = 200
  conditions = {Host = ["auth.oslira.com", "auth.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/auth/:splat"
  status = 200
  conditions = {Host = ["auth.oslira.com", "auth.oslira.org"]}

# ===========================
# üõ°Ô∏è ADMIN SUBDOMAIN - admin.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/admin/index.html"
  status = 200
  conditions = {Host = ["admin.oslira.com", "admin.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/admin/:splat"
  status = 200
  conditions = {Host = ["admin.oslira.com", "admin.oslira.org"]}

# ===========================
# üìû CONTACT SUBDOMAIN - contact.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/footer/contact/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/support"
  to = "/pages/footer/contact/support/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/security"
  to = "/pages/footer/contact/security/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/sales"
  to = "/pages/footer/contact/sales/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/bug-report"
  to = "/pages/footer/contact/bug-report/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/legal"
  to = "/pages/footer/contact/legal/index.html"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/footer/contact/:splat"
  status = 200
  conditions = {Host = ["contact.oslira.com", "contact.oslira.org"]}

# ===========================
# ‚öñÔ∏è LEGAL SUBDOMAIN - legal.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/footer/legal/index.html"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

[[redirects]]
  from = "/privacy"
  to = "/pages/footer/legal/privacy/index.html"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

[[redirects]]
  from = "/terms"
  to = "/pages/footer/legal/terms/index.html"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

[[redirects]]
  from = "/refund"
  to = "/pages/footer/legal/refund/index.html"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

[[redirects]]
  from = "/disclaimer"
  to = "/pages/footer/legal/disclaimer/index.html"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/footer/legal/:splat"
  status = 200
  conditions = {Host = ["legal.oslira.com", "legal.oslira.org"]}

# ===========================
# üìä STATUS SUBDOMAIN - status.oslira.{com|org}
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/footer/status/index.html"
  status = 200
  conditions = {Host = ["status.oslira.com", "status.oslira.org"]}

[[redirects]]
  from = "/*"
  to = "/pages/footer/status/:splat"
  status = 200
  conditions = {Host = ["status.oslira.com", "status.oslira.org"]}

# ===========================
# üè† ROOT DOMAIN - oslira.{com|org} - MARKETING PAGES
# ===========================
[[redirects]]
  from = "/"
  to = "/pages/home/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/about"
  to = "/pages/footer/about/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/pricing"
  to = "/pages/footer/pricing/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/case-studies"
  to = "/pages/footer/case-studies/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/docs"
  to = "/pages/footer/api/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/api"
  to = "/pages/footer/api/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/security"
  to = "/pages/footer/security/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/help"
  to = "/pages/footer/help/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/guides"
  to = "/pages/footer/guides/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/status"
  to = "/pages/footer/status/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/contact"
  to = "/pages/footer/contact/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

# Root domain fallbacks for app pages
[[redirects]]
  from = "/dashboard"
  to = "/pages/dashboard/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/admin"
  to = "/pages/admin/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/analytics"
  to = "/pages/analytics/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/auth"
  to = "/pages/auth/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/auth/callback"
  to = "/pages/auth/callback.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/campaigns"
  to = "/pages/campaigns/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/integrations"
  to = "/pages/integrations/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/leads"
  to = "/pages/leads/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/messages"
  to = "/pages/messages/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/onboarding"
  to = "/pages/onboarding/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/settings"
  to = "/pages/settings/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/subscription"
  to = "/pages/subscription/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

[[redirects]]
  from = "/automations"
  to = "/pages/automations/index.html"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

# Favicon
[[redirects]]
  from = "/favicon.ico"
  to = "/assets/images/oslira-logo.png"
  status = 200

# Root domain catch-all - MUST BE LAST
[[redirects]]
  from = "/*"
  to = "/pages/home/:splat"
  status = 200
  conditions = {Host = ["oslira.com", "www.oslira.com", "oslira.org", "www.oslira.org", "osliratest.netlify.app"]}

  # Absolute fallback - NO conditions
[[redirects]]
  from = "/*"
  to = "/pages/home/index.html"
  status = 200
